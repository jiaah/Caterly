#!/bin/sh

# ì»¤ë°‹ ë©”ì‹œì§€ íŒŒì¼ í™•ì¸
COMMIT_MESSAGE_FILE=$1
COMMIT_MESSAGE=$(cat "$COMMIT_MESSAGE_FILE")

# ì»¤ë°‹ ë©”ì‹œì§€ê°€ ë¹„ì–´ ìˆìœ¼ë©´ ì—ëŸ¬ ì¶œë ¥
if [ -z "$COMMIT_MESSAGE" ]; then
  echo "âŒ Commit message is empty. Please provide a commit message."
  exit 1
fi

# ì»¤ë°‹ ë©”ì‹œì§€ Lint ê²€ì‚¬
if ! npx --no-install commitlint --edit "$COMMIT_MESSAGE_FILE"; then
  echo ""
  echo "âŒ Invalid commit message format!"
  echo ""
  echo "ğŸ’¬ Please follow this format:"
  echo "  - Example 1: 'chore: configure prettier'"
  echo "  - Example 2: 'feat(web): implement dashboard page'"
  echo ""
  echo "ğŸ§¹ Allowed types: feat, fix, docs, style, refactor, perf, test, chore"
  echo "ğŸ“¦ Allowed scopes: web, admin, ui (or leave empty for root changes)"
  echo ""
  echo "ğŸ” Rules: Subject must NOT be PascalCase or UPPERCASE."
  exit 1
fi

# ì»¤ë°‹ ë©”ì‹œì§€ Lint ê²€ì‚¬ ì„±ê³µ
echo "âœ“ Commit message is valid."
echo "ğŸš€ Proceeding with commit..."

# ì»¤ë°‹ ë©”ì‹œì§€ê°€ ìœ íš¨í•˜ë©´ ì„±ê³µì ìœ¼ë¡œ ì¢…ë£Œ
exit 0

